<html>
<head>
	<script src="js/jquery.min.js"></script>
	<script>
		var markpoints = {
			"hockey-tennis-1": {
				"start": 0,
				"end": 1.9,
				"displayname": "",
				"next": [
				"tennis-3",
				"austin-ave"
				]
			},
			"tennis-3": {
				"start": 15.73,
				"end": 21.4,
				"displayname": "To Chase Road",
				"next": [
				"chase-road"
				]
			},
			"chase-road": {
				"start": 21.4,
				"end": 27.5,
				"displayname": "Chase Road",
				"next": [
				"valley-road-2"
				]
			},
			"austin-ave": {
				"start": 1.9,
				"end": 4.5,
				"displayname": "Austin Ave",
				"next": [
				"valley-road"
				]
			},
			"valley-road": {
				"start": 4.5,
				"end": 7.9,
				"displayname": "Valley Road",
				"next": [
				"valley-road-2"
				]
			},
			"valley-road-2": {
				"start": 7.9,
				"end": 9.0,
				"displayname": "Valley Road",
				"next": [
				"freeman-road"
				]
			},
			"freeman-road": {
				"start": 9.0,
				"end": 11.2,
				"displayname": "Freeman Road",
				"next": [
				"kingsford-road"
				]
			},
			"kingsford-road": {
				"start": 11.2,
				"end": 12.34,
				"displayname": "Kingsford Road",
				"next": [
				"14-kingsford-drive",
				"kingsford-road-2"
				]
			},
			"kingsford-road-2": {
				"start": 12.34,
				"end": 13.48,
				"displayname": "Kingsford Road",
				"next": [
				"12-kingsford-drive",
				]
			},
			"12-kingsford-drive": {
				"start": 13.48,
				"end": 14.6,
				"displayname": "12 Kingsford Road",
				"next": [
				"valley-road"
				]
			},
			"14-kingsford-drive": {
				"start": 28.06,
				"end": 29.9,
				"displayname": "14 Kingsford Road",
				"next": [
				"valley-road"
				]
			}
		};
		var currentSection = "hockey-tennis-1";
		var playing = true;
		function loadSection(section) {
			currentSection = section;
			video.currentTime = markpoints[currentSection].start;
			playing = true;
			video.play();
			$('#buttons').html('');
		}
		$(document).ready(function(){
			var video = document.getElementById("video");
			for (var i = 0; i < Object.keys(markpoints).length; i++) {
				var key = Object.keys(markpoints)[i];
				var mark = markpoints[key];
				$('#labels').append('<h1 class="markpoint-labels" id="' + key + '-label">' + mark.displayname + '</h1>');
				$('#' + key + '-label').hide();
			};
			video.ontimeupdate = function(){
				$('.markpoint-labels').hide();
				$('#' + currentSection + '-label').show();
				if (playing) {
					if (video.currentTime > markpoints[currentSection].end) {
						video.pause();
						video.currentTime = markpoints[currentSection].end;
						playing = false;
						$('#buttons').html('');
						if (markpoints[currentSection].next.length == 1) {
							loadSection(markpoints[currentSection].next[0]);
						} else if (markpoints[currentSection].next.length > 1) {
							for (var i = 0; i < markpoints[currentSection].next.length; i++) {
								$('#buttons').append('<button class="loadPointButton" loadPoint="' + markpoints[currentSection].next[i] + '">' + markpoints[markpoints[currentSection].next[i]].displayname + '</button>');
							}
						}
					}
				}
			};
			$(document).on('click','.loadPointButton', function(){
				loadSection($(this).attr('loadPoint'))
			});
		});
</script>
<script>
	function loadRegion(message) {
		alert(message);
	}
</script>
</head>
<body style="text-align:center;">
	<div class="video">
		<video height="80%" id="video" controls src="video.m4v">Your browser doesn't support the video tag!</video>
	</div>
	<br>
	<div id="buttons">

	</div>
	<br>
	<div id="labels" width="100%"></div>
</body>
</html>